# OA 系统功能细化方案

本文档基于《OA 系统规划草稿》，对各个功能模块进行详细设计与细化。

---

## 1. 核心基础模块

### 1.1 员工名录数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 员工编号 | Text | ✅ | 唯一标识，格式：EMP+YYYYMMDD+序号 |
| 姓名 | Title | ✅ | 员工姓名 |
| 英文名 | Text | ❌ | 英文名或昵称 |
| 性别 | Select | ✅ | 男/女 |
| 出生日期 | Date | ❌ | 用于生日提醒 |
| 联系电话 | Phone | ✅ | 手机号码 |
| 邮箱 | Email | ✅ | 公司邮箱 |
| 部门 | Relation | ✅ | 关联部门数据库 |
| 职位 | Select | ✅ | 职位级别与名称 |
| 直属上级 | Relation | ❌ | 关联员工数据库 |
| 入职日期 | Date | ✅ | 计算工龄 |
| 试用期状态 | Select | ✅ | 试用期内/已转正/已离职 |
| 员工状态 | Select | ✅ | 在职/离职/停薪留职 |
| 办公位置 | Text | ❌ | 工位号或楼层 |
| 头像 | Files | ❌ | 员工照片 |
| 紧急联系人 | Text | ❌ | 姓名+关系+电话 |

#### 视图设计
- **全部员工视图**：表格视图，显示所有员工信息
- **在职员工视图**：过滤条件=员工状态=在职
- **部门视图**：分组视图，按部门分组显示
- **试用期员工视图**：过滤条件=试用期状态=试用期内

#### 自动化功能
- 新员工入职时自动发送欢迎邮件
- 试用期到期前7天自动提醒转正评估
- 生日当天自动发送祝福通知

---

### 1.2 部门架构数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 部门编号 | Text | ✅ | 唯一标识，格式：DEPT+序号 |
| 部门名称 | Title | ✅ | 部门全称 |
| 部门简称 | Text | ❌ | 用于快速检索 |
| 上级部门 | Relation | ❌ | 关联自身，形成树形结构 |
| 部门负责人 | Relation | ✅ | 关联员工数据库 |
| 部门级数 | Formula | ✅ | 自动计算层级深度 |
| 部门人数 | Rollup | ✅ | 汇总该部门员工数 |
| 成立时间 | Date | ❌ | 部门成立时间 |
| 部门描述 | Text | ❌ | 部门职责说明 |
| 部门图标 | Files | ❌ | 用于展示 |

#### 视图设计
- **树形视图**：按上级部门分组，展示组织架构
- **部门负责人视图**：表格视图，显示负责人联系方式
- **部门人数统计视图**：看板视图，按人数范围分组

---

### 1.3 公共资源台账数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 资产编号 | Title | ✅ | 唯一标识，资产条形码 |
| 资产名称 | Text | ✅ | 物品名称 |
| 资产类别 | Select | ✅ | 电子设备/办公家具/图书/其他 |
| 品牌/型号 | Text | ❌ | 详细规格信息 |
| 购置日期 | Date | ✅ | 用于折旧计算 |
| 购置金额 | Number | ✅ | 原值 |
| 当前价值 | Formula | ❌ | 按折旧率计算 |
| 资产状态 | Select | ✅ | 库存中/使用中/借出/维修中/报废 |
| 保管人/使用人 | Relation | ❌ | 关联员工数据库 |
| 存放位置 | Text | ❌ | 具体位置 |
| 借出日期 | Date | ❌ | 当前借出时间 |
| 预计归还日期 | Date | ❌ | 借出时填写 |
| 维护记录 | Text | ❌ | 维修保养历史 |
| 资产图片 | Files | ❌ | 资产照片 |

#### 视图设计
- **全部资产视图**：表格视图
- **库存状态视图**：看板视图，按资产状态分组
- **借出资产视图**：表格视图，过滤借出状态，显示归还倒计时
- **资产分类视图**：分组视图，按资产类别分组

#### 自动化功能
- 借出到期前3天自动提醒归还
- 资产状态变更时通知相关人员

---

## 2. 审批与流程模块

### 2.1 请假/考勤管理数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 申请编号 | Title | ✅ | 自动生成：LEAVE+YYYYMMDD+序号 |
| 申请人 | Relation | ✅ | 关联员工数据库 |
| 部门 | Rollup | ✅ | 自动提取申请人部门 |
| 请假类型 | Select | ✅ | 年假/病假/事假/调休/婚假/产假/其他 |
| 开始时间 | Date | ✅ | 请假开始日期时间 |
| 结束时间 | Date | ✅ | 请假结束日期时间 |
| 请假时长 | Formula | ✅ | 自动计算小时数/天数 |
| 请假事由 | Text | ✅ | 详细说明 |
| 审批人 | Relation | ✅ | 默认为直属上级 |
| 审批状态 | Status | ✅ | 待提交/待审批/审批中/已通过/已驳回/已撤销 |
| 审批意见 | Text | ❌ | 审批人填写 |
| 审批时间 | Date | ❌ | 审批操作时间 |
| 附件 | Files | ❌ | 病假证明等材料 |
| 申请时间 | Created time | ✅ | 自动记录 |

#### 视图设计
- **我的申请视图**：过滤当前用户为申请人
- **待我审批视图**：过滤当前用户为审批人且状态=待审批
- **部门请假视图**：按部门分组，便于查看部门请假情况
- **日历视图**：在日历上显示请假时间段
- **请假统计视图**：按月份统计各类请假天数

#### 审批流程
1. 申请人提交申请 → 状态变为"待审批"
2. 审批人收到通知 → 点击按钮"开始审批" → 状态变为"审批中"
3. 审批人操作：
   - 点击"通过"按钮 → 状态变为"已通过"，发送通知给申请人
   - 点击"驳回"按钮 → 状态变为"已驳回"，需填写驳回理由
4. 申请人可撤销未审批的申请

#### 自动化功能
- 提交申请时自动通知审批人
- 审批结果自动通知申请人
- 年假余额不足时提示警告
- 连续请假超过3天需二级审批

---

### 2.2 费用报销数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 报销单号 | Title | ✅ | 自动生成：EXP+YYYYMMDD+序号 |
| 报销人 | Relation | ✅ | 关联员工数据库 |
| 部门 | Rollup | ✅ | 自动提取 |
| 报销类型 | Select | ✅ | 差旅费/招待费/办公用品/交通费/其他 |
| 报销金额 | Number | ✅ | 总金额 |
| 费用明细 | Text | ✅ | 每笔费用的说明、日期、金额 |
| 发票图片 | Files | ✅ | 发票凭证 |
| 发票类型 | Select | ✅ | 增值税专用发票/普通发票/电子发票 |
| 发票号码 | Text | ❌ | 发票编号 |
| 报销事由 | Text | ✅ | 业务说明 |
| 申请日期 | Date | ✅ | 提交报销日期 |
| 费用发生日期 | Date | ✅ | 实际消费日期 |
| 审批人 | Relation | ✅ | 部门负责人 |
| 财务审核人 | Relation | ✅ | 财务人员 |
| 审批状态 | Status | ✅ | 待提交/部门审批/财务审批/已打款/已驳回 |
| 部门审批意见 | Text | ❌ | 部门负责人填写 |
| 财务审批意见 | Text | ❌ | 财务人员填写 |
| 打款时间 | Date | ❌ | 实际打款日期 |
| 打款凭证 | Files | ❌ | 银行回单 |

#### 视图设计
- **我的报销视图**：个人报销记录
- **待审批视图**：审批人看板
- **财务审核视图**：财务专用视图
- **报销统计视图**：按部门、类型、月份统计

#### 审批流程
1. 报销人提交 → 部门负责人审批（业务真实性） → 财务审批（票据合规性） → 打款
2. 单笔报销超过5000元需总经理加签
3. 月度累计报销超过20000元需特别审批

---

### 2.3 物品领用与采购数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 申请单号 | Title | ✅ | 自动生成：PUR+YYYYMMDD+序号 |
| 申请人 | Relation | ✅ | 关联员工数据库 |
| 申请类型 | Select | ✅ | 领用/采购 |
| 物品名称 | Text | ✅ | 申请的物品 |
| 规格型号 | Text | ❌ | 详细规格 |
| 数量 | Number | ✅ | 申请数量 |
| 单价 | Number | ❌ | 采购时填写 |
| 总价 | Formula | ❌ | 数量×单价 |
| 用途说明 | Text | ✅ | 申请理由 |
| 紧急程度 | Select | ✅ | 普通/紧急/非常紧急 |
| 审批人 | Relation | ✅ | 部门负责人 |
| 行政确认人 | Relation | ✅ | 行政人员 |
| 审批状态 | Status | ✅ | 待提交/待审批/已审批/已驳回/已完成 |
| 库存状态 | Formula | ❌ | 自动关联公共资源台账 |
| 预计到货日期 | Date | ❌ | 采购时填写 |
| 实际发放日期 | Date | ❌ | 领用时填写 |

#### 视图设计
- **物品申请视图**：表格视图
- **待处理视图**：行政人员待办
- **库存预警视图**：显示库存不足物品

---

## 3. 行政与协同模块

### 3.1 会议室预定数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 预定编号 | Title | ✅ | 自动生成 |
| 会议主题 | Text | ✅ | 会议名称 |
| 会议室 | Select | ✅ | 会议室A/B/C/培训室 |
| 开始时间 | Date | ✅ | 预定开始时间（精确到分钟） |
| 结束时间 | Date | ✅ | 预定结束时间 |
| 预定人 | Relation | ✅ | 关联员工数据库 |
| 参会人数 | Number | ✅ | 预计人数 |
| 参会人员 | Relation | ❌ | 多选关联员工 |
| 会议描述 | Text | ❌ | 会议议程 |
| 需要设备 | Multi-select | ❌ | 投影仪/白板/视频会议/饮水机 |
| 会议状态 | Status | ✅ | 预定中/进行中/已结束/已取消 |
| 创建时间 | Created time | ✅ | 自动记录 |

#### 视图设计
- **日历视图**：按时间显示所有会议
- **时间轴视图**：按会议室分栏显示占用情况
- **我的预定视图**：个人预定记录

#### 自动化功能
- 会议开始前15分钟提醒参会人员
- 冲突检测：同一会议室同一时间段不能重复预定
- 会议结束后自动更新状态为"已结束"

---

### 3.2 公司公告栏数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 公告标题 | Title | ✅ | 公告标题 |
| 公告类型 | Select | ✅ | 公司制度/放假通知/重要新闻/活动通知 |
| 公告级别 | Select | ✅ | 普通/重要/紧急 |
| 发布部门 | Select | ✅ | 行政部/人事部/财务部/总经办 |
| 发布人 | Relation | ✅ | 关联员工数据库 |
| 发布日期 | Date | ✅ | 发布时间 |
| 公告内容 | Text | ✅ | 详细内容，支持富文本 |
| 附件 | Files | ❌ | 相关文档 |
| 是否置顶 | Checkbox | ✅ | 重要公告置顶显示 |
| 阅读人数 | Rollup | ❌ | 统计已阅读人数 |
| 截止日期 | Date | ❌ | 公告有效期 |

#### 视图设计
- **画廊视图**：卡片式展示，显示公告封面图
- **列表视图**：表格形式，便于浏览
- **按类型分组视图**：按公告类型分组

---

### 3.3 工作周报数据库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| 周报标题 | Title | ✅ | 格式：姓名-YYYY年第X周周报 |
| 汇报人 | Relation | ✅ | 关联员工数据库 |
| 部门 | Rollup | ✅ | 自动提取 |
| 汇报周期 | Date | ✅ | 选择该周的任意日期 |
| 本周工作内容 | Text | ✅ | 本周完成的任务与成果 |
| 下周工作计划 | Text | ✅ | 下周计划与目标 |
| 问题与风险 | Text | ❌ | 遇到的问题和需要的支持 |
| 关联项目 | Relation | ❌ | 关联项目数据库 |
| 工作进度 | Select | ✅ | 正常/滞后/提前 |
| 审阅人 | Relation | ✅ | 直属上级 |
| 审阅状态 | Select | ✅ | 未审阅/已审阅 |
| 审阅意见 | Text | ❌ | 上级反馈 |

#### 视图设计
- **我的周报视图**：个人汇报记录
- **待审阅视图**：上级查看下属周报
- **部门周报汇总视图**：按部门汇总

---

## 4. 知识与文档模块

### 4.1 公司维基知识库

#### 内容结构
```
公司维基
├── 新人入职指引
│   ├── 入职第一天清单
│   ├── 公司规章制度
│   ├── 组织架构介绍
│   └── 常用系统账号说明
├── 人事政策
│   ├── 薪酬福利制度
│   ├── 考勤休假制度
│   ├── 培训发展制度
│   └── 离职办理流程
├── 行政管理
│   ├── 办公环境管理
│   ├── 会议室使用规范
│   ├── 办公用品领用
│   └── 固定资产管理
├── 财务制度
│   ├── 报销流程
│   ├── 发票管理
│   └── 付款申请
└── IT支持
    ├── 邮箱使用指南
    ├── VPN配置说明
    ├── 常用软件下载
    └── 故障报修流程
```

#### 模板设计
- 每个页面包含：标题、最后更新时间、负责人、标签、正文内容、相关链接
- 使用嵌套页面结构，方便层级管理

---

### 4.2 SOP标准作业程序库

#### 数据结构设计
| 属性名称 | 属性类型 | 必填 | 说明 |
|---------|---------|------|------|
| SOP名称 | Title | ✅ | 流程名称 |
| 所属部门 | Select | ✅ | 人事/行政/财务/销售/技术/运营 |
| 流程类型 | Select | ✅ | 审批流程/操作规范/应急预案 |
| 流程编号 | Text | ✅ | 唯一编号 |
| 版本号 | Text | ✅ | V1.0, V1.1... |
| 生效日期 | Date | ✅ | 开始执行日期 |
| 编写人 | Relation | ✅ | 文档编写人 |
| 审核人 | Relation | ✅ | 部门负责人 |
| 流程描述 | Text | ✅ | 流程概述 |
| 操作步骤 | Text | ✅ | 详细步骤说明 |
| 流程图 | Files | ❌ | 流程图或截图 |
| 相关表单 | Files | ❌ | 附件下载 |
| 适用对象 | Multi-select | ✅ | 全员/管理层/特定岗位 |
| 更新记录 | Text | ❌ | 版本变更历史 |

#### 视图设计
- **按部门分类视图**：分组显示
- **最新更新视图**：按更新时间排序
- **热门SOP视图**：按浏览量排序

---

## 5. 权限管理方案

### 5.1 权限级别
- **系统管理员**：全部权限
- **部门管理员**：本部门数据管理权限
- **普通员工**：仅查看和编辑个人相关数据

### 5.2 数据访问控制
- 员工名录：所有人可查看，仅管理员可编辑
- 薪酬信息：仅本人和人事、财务可见
- 审批流程：申请人、审批人、管理员可见
- 公告栏：所有人可见，仅行政部门可发布

---

## 6. 实施建议

### 第一阶段（1-2周）
1. 搭建核心基础模块
   - 员工名录数据库
   - 部门架构数据库
   - 公共资源台账数据库

### 第二阶段（2-3周）
2. 实施审批流程
   - 请假/考勤管理
   - 费用报销
   - 物品领用

### 第三阶段（1-2周）
3. 完善行政协同
   - 会议室预定
   - 公告栏
   - 工作周报

### 第四阶段（持续）
4. 知识库建设
   - 公司维基
   - SOP文档

---

## 7. 扩展功能（未来可考虑）

- 7.1 客户关系管理（CRM）
- 7.2 项目管理模块
- 7.3 绩效考核系统
- 7.4 培训管理平台
- 7.5 员工调查问卷
- 7.6 车辆管理
- 7.7 访客管理系统
- 7.8 移动端适配

---

## 8. 系统集成建议

### 8.1 邮件集成
- 审批通知发送到企业邮箱
- 定期报告自动发送

### 8.2 即时通讯集成
- 与企业微信/钉钉/Slack集成
- 重要消息推送

### 8.3 日历同步
- 会议室预定同步到个人日历
- 请假记录同步到考勤系统

---

**文档版本**：V1.0
**最后更新**：2026-01-08
**维护人**：系统管理员
