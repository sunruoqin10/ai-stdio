<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.oa_system_backend.module.auth.mapper.AuthUserSessionMapper">

    <select id="selectActiveSessionByRefreshToken" resultType="com.example.oa_system_backend.module.auth.entity.AuthUserSession">
        SELECT * FROM auth_user_session
        WHERE refresh_token = #{refreshToken}
          AND is_active = 1
          AND expires_at > NOW()
        LIMIT 1
    </select>

    <select id="selectActiveSessionsByUserId" resultType="com.example.oa_system_backend.module.auth.entity.AuthUserSession">
        SELECT * FROM auth_user_session
        WHERE user_id = #{userId}
          AND is_active = 1
          AND expires_at > NOW()
        ORDER BY login_time DESC
    </select>

</mapper>
