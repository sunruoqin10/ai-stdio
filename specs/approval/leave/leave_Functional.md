# 请假管理模块 - 功能需求规范

> **文档类型**: 功能需求规范 (Functional Specification)
> **模块类型**: 审批流程
> **复杂度**: ⭐⭐⭐⭐ (4星)
> **创建日期**: 2026-01-09
> **版本**: v1.0.0

---

## 1. 功能概述

实现员工请假申请、审批、统计的全流程管理,支持多级审批、自动计算时长、余额提醒等功能。

### 1.1 业务价值
- 规范请假流程,提高审批效率
- 自动计算工作日,减少人工错误
- 多级审批确保请假合理性
- 年假余额管理,保障员工权益
- 数据统计分析,辅助管理决策

---

## 2. 用户故事

### 2.1 普通员工
**作为**一名员工
**我想要**在线提交请假申请
**以便于**快速完成请假流程并获得审批结果

**验收标准:**
- 可以选择多种请假类型
- 可以查看年假余额
- 自动计算请假时长
- 可以随时查看审批进度
- 收到审批结果通知

### 2.2 部门负责人
**作为**部门负责人
**我想要**审批本部门员工的请假申请
**以便于**合理安排部门工作

**验收标准:**
- 查看待审批申请列表
- 查看员工请假详情和历史
- 可以通过或驳回申请
- 可以填写审批意见
- 查看本部门请假统计

### 2.3 人事专员
**作为**人事专员
**我想要**审批所有员工的请假申请
**以便于**监督全公司请假情况

**验收标准:**
- 查看待审批申请列表
- 可以审批跨部门请假
- 查看全公司请假统计报表
- 管理员工年假额度

### 2.4 总经理
**作为**总经理
**我想要**审批长期请假申请
**以便于**掌控公司人员动态

**验收标准:**
- 查看长期请假申请(>7天)
- 审批重要人员的请假
- 查看全公司请假统计

---

## 3. 功能清单

### 3.1 请假申请 (优先级: P0)
- [ ] 创建请假申请
- [ ] 选择请假类型
- [ ] 选择开始/结束时间
- [ ] 自动计算请假时长
- [ ] 填写请假事由
- [ ] 上传附件(病假证明等)
- [ ] 保存草稿
- [ ] 提交申请
- [ ] 撤销申请(待审批时)
- [ ] 查看我的申请列表
- [ ] 查看申请详情
- [ ] 重新提交被驳回的申请

### 3.2 审批管理 (优先级: P0)
- [ ] 查看待审批申请
- [ ] 查看申请详情
- [ ] 通过申请
- [ ] 驳回申请(填写意见)
- [ ] 查看审批历史
- [ ] 查看已审批列表
- [ ] 批量审批

### 3.3 年假管理 (优先级: P1)
- [ ] 查看年假余额
- [ ] 查看年假使用记录
- [ ] 年假余额预警(<3天)
- [ ] 自动计算年假额度
- [ ] 年假消耗统计

### 3.4 统计报表 (优先级: P1)
- [ ] 个人请假统计
- [ ] 部门请假统计
- [ ] 全公司请假统计
- [ ] 请假类型分布
- [ ] 请假趋势分析
- [ ] 导出统计报表

### 3.5 日历视图 (优先级: P2)
- [ ] 月度请假日历
- [ ] 按人员筛选
- [ ] 按部门筛选
- [ ] 按类型筛选
- [ ] 查看每日请假详情

---

## 4. 请假流程

### 4.1 流程状态图
```
待提交 → 待审批 → 审批中 → 已通过
  ↓        ↓         ↓
已撤销   已驳回   已驳回
```

### 4.2 流程说明

#### 4.2.1 待提交
- 员工创建请假申请,填写信息
- 可以保存为草稿
- 可以修改和删除
- 提交后进入"待审批"状态

#### 4.2.2 待审批
- 等待第一个审批人审批
- 申请人可以撤销申请
- 撤销后回到"待提交"状态

#### 4.2.3 审批中
- 正在多级审批流程中
- 显示当前审批层级
- 显示已审批的记录
- 申请人不能撤销

#### 4.2.4 已通过
- 所有审批人通过
- 如果是年假,自动扣减余额
- 不可修改
- 可以查看详情

#### 4.2.5 已驳回
- 任一审批人驳回
- 整个申请被驳回
- 申请人可以修改后重新提交
- 显示驳回意见

#### 4.2.6 已撤销
- 申请人主动撤销
- 只能在"待审批"状态撤销
- 可以重新提交

---

## 5. 业务规则

### 5.1 请假类型

| 类型 | 编码 | 说明 | 是否需要附件 | 是否扣减年假 |
|------|------|------|-------------|-------------|
| 年假 | annual | 带薪假期 | 否 | 是 |
| 病假 | sick | 因病请假 | 是(建议) | 否 |
| 事假 | personal | 私事请假 | 否 | 否 |
| 调休 | comp_time | 加班调休 | 否 | 否 |
| 婚假 | marriage | 结婚假期 | 是 | 否 |
| 产假 | maternity | 生育假期 | 是 | 否 |

### 5.2 多级审批规则

#### 5.2.1 审批层级

| 请假天数 | 审批人 | 说明 |
|---------|--------|------|
| ≤3天 | 部门负责人 | 一级审批 |
| 4-7天 | 部门负责人 + 人事 | 二级审批 |
| >7天 | 部门负责人 + 人事 + 总经理 | 三级审批 |

#### 5.2.2 审批顺序
1. 第一级: 部门负责人审批
2. 第二级: 人事专员审批
3. 第三级: 总经理审批

**规则说明:**
- 必须按顺序审批,不能跳级
- 任一级驳回,整个申请驳回
- 所有级通过,申请才通过
- 审批人不能审批自己的申请

#### 5.2.3 特殊情况
- 部门负责人请假: 由上级负责人或人事审批
- 人事请假: 由总经理审批
- 总经理请假: 无需审批(系统记录)

### 5.3 请假时长计算

#### 5.3.1 计算规则
- 只计算工作日(周一到周五)
- 排除法定节假日
- 排除公司统一假期
- 半天请假按0.5天计算
- 跨月连续请假累加计算

#### 5.3.2 时间精度
- 支持按天请假
- 支持按半天请假(上午/下午)
- 不支持按小时请假

#### 5.3.3 计算示例

**示例1: 5天连续请假**
- 开始: 2026-01-06 (周一)
- 结束: 2026-01-10 (周五)
- 时长: 5个工作日

**示例2: 跨周末请假**
- 开始: 2026-01-06 (周一)
- 结束: 2026-01-12 (周日)
- 时长: 5个工作日 (排除周末)

**示例3: 跨节假日请假**
- 开始: 2026-01-27 (周一,春节前)
- 结束: 2026-02-05 (周三,春节后)
- 时长: 3个工作日 (排除春节假期)

### 5.4 年假管理规则

#### 5.4.1 年假额度标准

| 工作年限 | 年假天数 | 说明 |
|---------|---------|------|
| <1年 | 0天 | 试用期无年假 |
| 1-9年 | 5天 | 基础年假 |
| 10-19年 | 10天 | 资深员工 |
| ≥20年 | 15天 | 长期服务 |

#### 5.4.2 年假计算
- **计算基准日**: 每年1月1日
- **计算方式**: 按员工入职日期计算工作年限
- **生效时间**: 新员工入职满1年后自动生效
- **清零时间**: 每年12月31日清零,不跨年累积

#### 5.4.3 年假使用规则
- 必须提前申请年假(建议≥1天)
- 年假可以分段使用
- 年假余额不足时不能提交申请
- 离职时未使用年假不予折现

#### 5.4.4 年假预警
- **黄色预警**: 余额≤3天,提示"年假余额不足"
- **红色预警**: 余额=0天,禁止提交年假申请

### 5.5 自动提醒规则

#### 5.5.1 提交提醒
- **触发时机**: 提交申请时
- **提醒对象**: 当前审批人
- **提醒内容**: 收到新的请假申请,请及时审批
- **提醒方式**: 系统通知 + 邮件(可选)

#### 5.5.2 审批结果提醒
- **触发时机**: 审批完成时(通过/驳回)
- **提醒对象**: 申请人
- **提醒内容**: 您的请假申请已通过/已驳回
- **提醒方式**: 系统通知 + 邮件(可选)

#### 5.5.3 余额预警
- **触发时机**: 查看年假余额时
- **提醒对象**: 申请人
- **提醒内容**: 年假余额不足X天,请合理安排
- **提醒方式**: 页面提示

#### 5.5.4 长期请假预警
- **触发时机**: 连续请假>3天时
- **提醒对象**: 申请人
- **提醒内容**: 您的请假超过3天,将需要二级审批
- **提醒方式**: 页面提示

#### 5.5.5 审批超时提醒
- **触发时机**: 申请提交超过24小时未审批
- **提醒对象**: 审批人
- **提醒内容**: 您有X条请假申请待审批,请及时处理
- **提醒方式**: 系统通知

---

## 6. 功能优先级

### 6.1 P0 - 核心功能 (必须实现)
- 请假申请创建和提交
- 多级审批流程
- 请假时长自动计算
- 审批通过/驳回
- 申请列表和详情查看

### 6.2 P1 - 重要功能 (优先实现)
- 年假余额管理
- 年假额度自动计算
- 请假统计报表
- 年假余额预警
- 审批超时提醒

### 6.3 P2 - 辅助功能 (后续实现)
- 日历视图
- 批量审批
- 导出功能
- 移动端适配

---

## 7. 非功能需求

### 7.1 性能要求
- 页面加载时间 < 2秒
- 审批操作响应时间 < 1秒
- 支持至少100个并发用户

### 7.2 安全要求
- 审批操作需要登录验证
- 审批权限需要角色验证
- 防止越权审批
- 审批记录不可删除,只能作废

### 7.3 可用性要求
- 界面简洁直观
- 操作流程清晰
- 错误提示友好
- 支持移动端访问

---

**文档版本**: v1.0.0
