# OA系统后端模块开发顺序指南

本文档描述了OA系统各后端模块的推荐开发顺序，基于业务逻辑和模块依赖关系。

## 开发顺序总览

```
第一阶段：基础权限模块
├─ ✅ 认证模块 (auth) - 已完成

第二阶段：核心基础模块
├─ 部门管理 (sys_department)
├─ 员工管理 (sys_employee)
├─ 角色管理 (sys_role)
├─ 权限管理 (sys_permission)
└─ 菜单管理 (sys_menu)

第三阶段：字典管理
├─ 字典类型管理 (sys_dict_type)
└─ 字典项管理 (sys_dict_item)

第四阶段：业务模块
├─ 资产管理 (biz_asset)
├─ 请假管理 (approval_leave_*)
├─ 报销管理 (approval_expense_*)
└─ 会议管理 (admin_meeting_*)

第五阶段：日志监控
└─ 操作日志 (sys_employee_operation_log)
```

---

## 第一阶段：基础权限模块 ✅

### ✅ 认证模块 (auth)
**状态：已完成**

**功能：**
- 用户登录/登出
- JWT Token生成和验证
- 刷新Token机制
- 图形验证码
- 邮箱/手机验证码
- 密码重置
- 登录日志记录
- 会话管理

**相关表：**
- `auth_user` - 用户账号表
- `auth_user_session` - 用户会话表
- `auth_login_log` - 登录日志表
- `auth_verification_code` - 验证码表
- `auth_password_history` - 密码历史表

**依赖：** 无

---

## 第二阶段：核心基础模块

### 1️⃣ 部门管理 (sys_department)
**优先级：⭐⭐⭐⭐⭐**

**功能：**
- 部门CRUD操作
- 部门树形结构
- 部门成员管理

**相关表：**
- `sys_department` - 部门表
- `sys_department_member` - 部门成员关系表

**依赖：** 无

**为什么优先开发：**
- 员工、角色、菜单等模块都需要关联部门
- 组织架构的基础

---

### 2️⃣ 员工管理 (sys_employee)
**优先级：⭐⭐⭐⭐⭐**

**功能：**
- 员工信息CRUD
- 员工详情查询
- 员工与部门关联
- 员工操作日志

**相关表：**
- `sys_employee` - 员工表
- `sys_employee_operation_log` - 员工操作日志表

**依赖：**
- 部门管理 (sys_department)

**为什么优先开发：**
- 登录后需要显示用户完整信息（姓名、工号、部门、职位等）
- 请假、报销、会议等所有业务模块都需要关联员工
- 完善用户认证信息

**核心接口：**
```
GET    /api/employees          - 员工列表
GET    /api/employees/{id}     - 员工详情
POST   /api/employees          - 创建员工
PUT    /api/employees/{id}     - 更新员工
DELETE /api/employees/{id}     - 删除员工
GET    /api/employees/me        - 当前登录员工信息
```

---

### 3️⃣ 角色管理 (sys_role)
**优先级：⭐⭐⭐⭐**

**功能：**
- 角色CRUD操作
- 角色权限分配
- 用户角色关联

**相关表：**
- `sys_role` - 角色表
- `sys_user_role` - 用户角色关系表

**依赖：** 无

**为什么优先开发：**
- 权限控制的核心
- 菜单显示依赖角色
- 与权限、菜单模块配合使用

**核心接口：**
```
GET    /api/roles              - 角色列表
GET    /api/roles/{id}         - 角色详情
POST   /api/roles              - 创建角色
PUT    /api/roles/{id}         - 更新角色
DELETE /api/roles/{id}         - 删除角色
POST   /api/roles/{id}/permissions  - 分配权限
GET    /api/roles/{id}/permissions  - 获取角色权限
```

---

### 4️⃣ 权限管理 (sys_permission)
**优先级：⭐⭐⭐⭐**

**功能：**
- 权限定义
- 权限分类（菜单权限、按钮权限、数据权限）
- 权限树形结构

**相关表：**
- `sys_permission` - 权限表
- `sys_role_permission` - 角色权限关系表

**依赖：** 无

**为什么优先开发：**
- 系统安全的基础
- 角色和菜单模块依赖权限

**核心接口：**
```
GET    /api/permissions        - 权限列表
GET    /api/permissions/{id}   - 权限详情
POST   /api/permissions        - 创建权限
PUT    /api/permissions/{id}   - 更新权限
DELETE /api/permissions/{id}   - 删除权限
GET    /api/permissions/tree   - 权限树
```

---

### 5️⃣ 菜单管理 (sys_menu)
**优先级：⭐⭐⭐⭐**

**功能：**
- 菜单CRUD操作
- 菜单树形结构
- 菜单与权限关联
- 根据用户角色获取菜单

**相关表：**
- `sys_menu` - 菜单表
- `sys_role_menu` - 角色菜单关系表

**依赖：**
- 权限管理 (sys_permission)

**为什么优先开发：**
- 前端页面导航的基础
- 登录后需要根据角色显示菜单
- 与权限控制配合使用

**核心接口：**
```
GET    /api/menus              - 菜单列表
GET    /api/menus/tree         - 菜单树
GET    /api/menus/user         - 当前用户菜单
POST   /api/menus              - 创建菜单
PUT    /api/menus/{id}         - 更新菜单
DELETE /api/menus/{id}         - 删除菜单
```

---

## 第三阶段：字典管理

### 6️⃣ 字典管理 (sys_dict)
**优先级：⭐⭐⭐**

**功能：**
- 字典类型管理
- 字典项管理
- 字典缓存

**相关表：**
- `sys_dict_type` - 字典类型表
- `sys_dict_item` - 字典项表

**依赖：** 无

**为什么需要：**
- 为其他模块提供下拉选项
- 部门、职位、状态等枚举值
- 系统配置统一管理

**核心接口：**
```
GET    /api/dict/types         - 字典类型列表
POST   /api/dict/types         - 创建字典类型
GET    /api/dict/items/{type}  - 获取字典项
POST   /api/dict/items         - 创建字典项
```

---

## 第四阶段：业务模块

### 7️⃣ 资产管理 (biz_asset)
**优先级：⭐⭐⭐**

**功能：**
- 资产信息管理
- 资产借用记录
- 资产维护记录

**相关表：**
- `biz_asset` - 资产表
- `biz_asset_borrow_record` - 资产借用记录表
- `biz_asset_maintenance` - 资产维护记录表

**依赖：**
- 员工管理 (sys_employee)

**核心接口：**
```
GET    /api/assets             - 资产列表
POST   /api/assets             - 创建资产
PUT    /api/assets/{id}        - 更新资产
POST   /api/assets/{id}/borrow - 借用资产
POST   /api/assets/{id}/return - 归还资产
```

---

### 8️⃣ 请假管理 (approval_leave)
**优先级：⭐⭐⭐⭐**

**功能：**
- 请假申请
- 请假审批流程
- 请假余额管理
- 请假记录查询

**相关表：**
- `approval_leave_request` - 请假申请表
- `approval_leave_approval` - 请假审批表
- `approval_leave_balance` - 请假余额表
- `approval_leave_usage_log` - 请假使用日志表
- `approval_holiday` - 法定节假日表

**依赖：**
- 员工管理 (sys_employee)
- 部门管理 (sys_department)

**核心接口：**
```
GET    /api/leave/requests     - 请假申请列表
POST   /api/leave/requests     - 创建请假申请
PUT    /api/leave/requests/{id}/approve  - 审批请假
GET    /api/leave/balance      - 请假余额查询
```

---

### 9️⃣ 报销管理 (approval_expense)
**优先级：⭐⭐⭐**

**功能：**
- 报销申请
- 报销审批流程
- 报销明细管理
- 发票管理
- 付款记录

**相关表：**
- `approval_expense` - 报销单表
- `approval_expense_item` - 报销明细表
- `approval_expense_invoice` - 发票表
- `approval_expense_payment` - 付款记录表

**依赖：**
- 员工管理 (sys_employee)
- 部门管理 (sys_department)

**核心接口：**
```
GET    /api/expenses           - 报销单列表
POST   /api/expenses           - 创建报销单
PUT    /api/expenses/{id}/approve  - 审批报销
POST   /api/expenses/{id}/payment   - 付款
```

---

### 🔟 会议管理 (admin_meeting)
**优先级：⭐⭐⭐**

**功能：**
- 会议室管理
- 会议室预订
- 预订冲突检测

**相关表：**
- `admin_meeting_room` - 会议室表
- `admin_meeting_booking` - 会议室预订表

**依赖：**
- 员工管理 (sys_employee)

**核心接口：**
```
GET    /api/meeting/rooms      - 会议室列表
GET    /api/meeting/rooms/{id}/bookings  - 会议室预订记录
POST   /api/meeting/bookings   - 创建预订
DELETE /api/meeting/bookings/{id}  - 取消预订
```

---

## 第五阶段：日志监控

### 1️⃣1️⃣ 操作日志 (sys_employee_operation_log)
**优先级：⭐⭐**

**功能：**
- 用户操作记录
- 操作审计
- 日志查询

**相关表：**
- `sys_employee_operation_log` - 操作日志表

**依赖：**
- 员工管理 (sys_employee)

**核心接口：**
```
GET    /api/operation/logs     - 操作日志列表
GET    /api/operation/logs/{id} - 日志详情
```

---

## 立即开始的推荐

考虑到当前的认证模块已完成，我建议按以下顺序继续开发：

### 🔥 立即开始：员工管理模块
**原因：**
1. **登录后立即需要** - 显示用户完整信息
2. **其他模块依赖** - 请假、报销、会议都需要员工信息
3. **完善认证信息** - 将auth_user与sys_employee关联

### 第二步：部门管理模块
**原因：**
1. 员工属于部门
2. 组织架构展示
3. 为后续模块提供部门数据

### 第三步：角色和菜单管理
**原因：**
1. 登录后根据角色显示菜单
2. 权限控制
3. 前端路由和按钮权限

### 第四步：字典管理
**原因：**
1. 为其他模块提供下拉数据
2. 系统配置统一管理

---

## 开发注意事项

### 1. 数据库字段映射
所有实体类需要正确映射数据库字段：
```java
@TableField("db_column_name")
private String javaFieldName;
```

### 2. 逻辑删除
所有表需要添加 `is_deleted` 字段和逻辑删除配置：
```java
@TableLogic
@TableField("is_deleted")
private Integer isDeleted;
```

### 3. 统一返回格式
使用 `ApiResponse` 包装所有API返回：
```java
return ApiResponse.success(data);
return ApiResponse.error("错误信息");
```

### 4. 分页查询
使用 MyBatis Plus 的 `Page` 对象：
```java
Page<Entity> page = new Page<>(pageNum, pageSize);
Page<Entity> result = mapper.selectPage(page, wrapper);
```

### 5. 异常处理
使用统一的异常类：
- `BusinessException` - 业务异常
- `AuthenticationException` - 认证异常
- `ResourceNotFoundException` - 资源不存在

### 6. DTO和VO分离
- DTO (Data Transfer Object) - 接收请求参数
- VO (View Object) - 返回视图数据
- Entity - 数据库实体

### 7. 权限验证
使用Spring Security进行权限控制：
```java
@PreAuthorize("hasAuthority('employee:view')")
public ApiResponse<EmployeeVO> getEmployee(String id) {
    // ...
}
```

---

## 开发检查清单

每个模块开发完成后，检查以下内容：

- [ ] Entity实体类字段映射正确
- [ ] Mapper接口和XML配置
- [ ] Service业务逻辑
- [ ] Controller接口定义
- [ ] DTO和VO类
- [ ] 异常处理
- [ ] 日志记录
- [ ] 单元测试
- [ ] API文档
- [ ] 前端对接

---

**更新时间：** 2026-01-13
**当前进度：** 认证模块已完成，建议下一步开发员工管理模块
